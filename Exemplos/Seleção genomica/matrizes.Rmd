---
title: "R Notebook"
output: html_notebook
---



```{r}

```


```{r}
p <- apply(M, 2, mean)/2

```


```{r}
P <- matrix(rep(p*2, nrow(M)), ncol=ncol(M), nrow=nrow(M), byrow=TRUE)
rownames(P) <- rownames(M)
colnames(P) <- colnames(M)
P[1:10, 1:10]

```


```{r}
Z <- as.matrix(M - P)
Z[1:10, 1:10]

```


```{r}
q <- 1 - p
sum2pq <- 2*sum(p*q)  
sum2pq

```


```{r}
G <- tcrossprod(Z, Z) / sum2pq
G[1:10, 1:10]

```



```{r}

```


```{r}
Z <- as.matrix(Z)
mhat <- m.cat
ghat <- g.hat

mhat=solve(t(Z)%*%Z)%*%t(Z)%*%ghat
```










```{r}
Z <- as.matrix(Z)
solve(crossprod(Z, Z), crossprod(Z, ghat))
```

